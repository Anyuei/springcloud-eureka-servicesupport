
<!-- World 界面 -->
<style>

  /*种类按钮 样式*/
  .categoriesBtnStyle{
    color: #656565 !important;
    padding: 11px 28px;
    font-size: 16px;
    line-height: 0.5;
    border-radius: 18px;
    background-color: #eef5f9;
    border-color: #eef5f9;
  }
  .categoriesBtnStyle:hover{
    color: #ebebeb !important;
    padding: 11px 28px;
    font-size: 16px;
    line-height: 0.5;
    border-radius: 18px;
    background-color:#9fcdff;
    border-color: #eef5f9;
  }
  /*对象标题样式*/
  .itemNameStyle{
    font-size: larger;
    padding: 16px 0px 0px 16px;
  }

  .itemNameStyle:hover{
     font-size: larger;
     color: #bd2130;
  }
  /*对象图片样式*/
  .itemBgImgStyle img{
    top: 0px;
    transition: all 1s;
    -moz-transition: all 1s;
    -webkit-transition: all 1s;
    -o-transition: all 1s;
    position: relative;
  }
  .itemBgImgStyle img:hover{
    top: -6px;
    width: 105%;
    height: 105%;
  }
  .likesIcon{
    color: #ba0000;
  }
  .likesIcon:hover{
    color: #f00;
  }
  .likesIcon:focus{
    color: #f00;
  }
  .ItemOperationArea{
    position:absolute;
    bottom:5px;
  }
</style>
  <!-- 评论区-->
  <header class="page-header">
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-6">
           <h2 class="no-margin-bottom">World</h2>
        </div>
        <!-- 搜索栏 -->
        <div class="col-lg-6">
          <div class="input-group">
            <input id="itemsKey" type="text" class="form-control" aria-label="Text input with segmented dropdown button" placeholder="请输入关键词">
            <div class="input-group-append">
              <button id="searchItems" type="button" class="btn btn-outline-secondary">search</button>
              <button type="button" class="btn btn-outline-secondary dropdown-toggle dropdown-toggle-split" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="sr-only">Toggle Dropdown</span>
              </button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="#">全站搜索</a>
                <a class="dropdown-item" href="#">精确搜索</a>
                <a class="dropdown-item" href="#">模糊搜索</a>
                <div role="separator" class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">类目下搜索</a>
              </div>
            </div>
          </div>
        </div>
        <!-- 搜索栏 end-->

      </div>
    </div>
  </header>
  <!-- Breadcrumb-->
<!--  <div class="breadcrumb-holder container-fluid">
    <ul class="breadcrumb">
      <li class="breadcrumb-item"><a href="index.html">Home</a></li>
      <li class="breadcrumb-item active">Tables</li>
    </ul>
  </div>-->
  <!--类目导航条-->
  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" id="Item1">
      <a class="nav-link active" id="CategoryNav1" data-toggle="tab" href="#CategoryArea1" role="tab" aria-controls="CategoryArea1" aria-selected="true">主分类</a>
    </li>
    <!--此处代码由getCategories()方法生成-->
  </ul>
  <!--详细类目显示区-->
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="CategoryArea1" role="tabpanel" aria-labelledby="CategoryArea1-tab">
      <!--此处代码由setSubcategories()方法生成-->
    </div>
  </div>


  <section class="tables">
    <div class="container-fluid">
      <div class="row itemsArea_SearchResult">
        <div class="col-lg-12 card">
          <div class="row">
            <div class="col-lg-3">
              <img src="${request.contextPath }/img/objectsImages/star_img/ycy.jpeg" width="100%" height="100%">
            </div>
            <div class="col-lg-9">
              <div class="">
                12312313
              </div>
              <hr>
              <div class="">
                11111111111111
              </div>
            </div>
          </div>
        </div>
        <br>
          <div class="col-lg-12 card">
            <div class="row">
              <div class="col-lg-3">
                <img src="${request.contextPath }/img/objectsImages/performer_img/gakki_Main_bg.jpg" width="100%" height="100%">
              </div>
              <div class="col-lg-9">
                <div class="">
                  gakki
                </div>
                <hr>
                <div class="">
                  11111111111111
                </div>
              </div>
            </div>
          </div>

<!--        <div class="col-lg-6">
          <div class="card">
            <div class="card-close">
              <div class="dropdown">
                <button type="button" id="closeCard4" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-ellipsis-v"></i></button>
                <div aria-labelledby="closeCard4" class="dropdown-menu dropdown-menu-right has-shadow"><a href="#" class="dropdown-item remove"> <i class="fa fa-times"></i>Close</a><a href="#" class="dropdown-item edit"> <i class="fa fa-gear"></i>Edit</a></div>
              </div>
            </div>
            <div class="card-header d-flex align-items-center">
              <h3 class="h4">Compact Table</h3>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped table-sm">
                  <thead>
                  <tr>
                    <th>#</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Username</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr>
                    <th scope="row">1</th>
                    <td>Mark</td>
                    <td>Otto</td>
                    <td>@mdo</td>
                  </tr>
                  <tr>
                    <th scope="row">2</th>
                    <td>Jacob</td>
                    <td>Thornton</td>
                    <td>@fat</td>
                  </tr>
                  <tr>
                    <th scope="row">3</th>
                    <td>Larry</td>
                    <td>the Bird</td>
                    <td>@twitter      </td>
                  </tr>
                  <tr>
                    <th scope="row">4</th>
                    <td>Mark</td>
                    <td>Otto</td>
                    <td>@mdo</td>
                  </tr>
                  <tr>
                    <th scope="row">5</th>
                    <td>Jacob</td>
                    <td>Thornton</td>
                    <td>@fat</td>
                  </tr>
                  <tr>
                    <th scope="row">6</th>
                    <td>Larry</td>
                    <td>the Bird</td>
                    <td>@twitter      </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>-->
      </div>
    </div>
  </section>
  <!-- Page Footer-->
<script>
    /* 初次进入加载根类目 */
    $(function() {
        getCategories(1);//根类目ID为1
    })
    //根据父类ID获取子类，并把子类数据追加在父类数据区div之后。
    function getCategories(supCategoryID){
        console.log(supCategoryID);
        var supCategoryArea = "CategoryArea"+supCategoryID;
        $.ajax({
            type: 'get',
            url: '${request.contextPath }/category/getSubCategories?supCategoryID='+supCategoryID,
            async: true,
            dataType:"json",
            success: function(data) {
                console.log("类目获取成功"+data);
                if(data !=null) {
                    var categories = "";//<ul class='nav'>
                    $.each(data,function(index,element){
                        console.log(element['categoryName']);
                        categories +=
                            "<a class='categoriesBtnStyle' onclick='setSubcategories("
                            +element['categoryID']+",\""
                            +element['categoryName']+"\","+
                            +element['supCategoryID']+
                            ")' class='btn btn-secondary btn-lg' role='button' aria-disabled='true'>" +
                            element['categoryName'] +
                            "</a>";
                    });
                    console.log(categories);
                    $('#'+supCategoryArea).append(categories/*+'</tr>'*/)//追加数据
                } else {
                    alert("error");
                }
            },
            error: function() {
                alert("网络错误");
            }
        });
    }
    //获取类ID，类名，父类ID
    //类目被点击后，刷新导航条，和数据区。在响应类目后面追加导航Nav及数据区追加类目。
    function setSubcategories(categoryID,categoryName,supCategoryID){
        console.log(categoryID,categoryName,supCategoryID);
        //父类导航Item，用于被子类追加导航
        var supCategoryItemID = "Item"+supCategoryID;
        //父类区Area，用于被子类追加数据区
        var supCategoryAreaID = "CategoryArea"+supCategoryID;
        //子类导航
        var categoryItemID = "Item"+categoryID;
        //Nav用于被激活
        var categoryNavID = "CategoryNav"+categoryID;
        //子类区
        var CategoryAreaID = "CategoryArea"+categoryID;
        var CategoryAreaIDTab ="CategoryArea"+categoryID+"-tab";
        //先清除当前父类导航项之后的导航项
        $('#'+supCategoryItemID).nextAll().remove();
        //在当前父类supCategoryID导航项之后的添加新的当前类目categoryID的导航项
        var cateItemArea = "<li class='nav-item' id='"+categoryItemID+"'><a class='nav-link'"+
            "id='"+categoryNavID+"' data-toggle='tab'" +
            "href='#"+CategoryAreaID+"'role='tab' aria-controls='"+CategoryAreaID+"' aria-selected='true'>"+categoryName+"</a></li>";
        $('#'+supCategoryItemID).after(""+
            cateItemArea
        );

        //先清除当前父类导航项显示区。
        $('#'+supCategoryAreaID).nextAll().remove();
        //把当前类的子类数据追加到当前类目的父类导航项显示区的后面--------
        var subCategoryArea="<div class='tab-pane fade' id='"+CategoryAreaID+"'role='tabpanel'" +
            "aria-labelledby='"+CategoryAreaIDTab+"'></div>"
        $('#'+supCategoryAreaID).after(subCategoryArea)//显示数据
        //--------
        getCategories(categoryID);//获取类目，并追加数据
        activeBtn(categoryNavID);//激活Button
    }
/*    <a class="nav-link active show" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">*/
    //根据tab的ID激活tab
    function activeBtn(btn){
        $('#'+btn).tab('show');
        //$('#myTab a[href=tab1]').tab('show');//备选方案
    }

    /*搜索 被评论对象*/
    $('#searchItems').click(function(){
        /*获取关键词*/
        var itemKey = $('#itemsKey').val();

        /*判断空值*/
        if(itemKey == ''){
            alert('搜索内容不能为空！');
        }else{
            $.ajax({
                type: 'get',
                url: '${request.contextPath }/items/searchByName/'+itemKey,//infos查所有
                async: true,
                dataType: 'json',
                success: function(data) {
                    $('.itemsArea_SearchResult').html("");
                    console.log(data);
                    var HTML_TXT="";
                    $.each(data,function(index,element){
                        var islike ="fa-heart-o";
                        /*用来判定当前对象是否被当前用户点赞过，一遍显示不同的点赞状态*/
                        if(element['islike']==true){
                            islike= "fa-heart"
                        }
                        HTML_TXT +=
                            /* 对象展示核心 Html 代码 */
                            "<div class='col-lg-12 card'>"+
                              "<div class='row'>"+
                                "<div class='col-lg-3 itemBgImgStyle'>"+
                                  "<img src='${request.contextPath }" + element['objectPicturePath']+ "' width='100%' height='100%'>"+
                                "</div>"+
                                "<div class='col-lg-9'>"+
                                  "<h3 class='itemNameStyle'>"+
                                     element['objectName']+
                                  "</h3>"+
                                  "<hr>"+
                                  "<div class=''>"+
                                     element['brief_introduction']+
                                  "</div><br>"+
                                  "<div class='ItemOperationArea'>"+
                                    "<a class='likesIcon' href='javascript:void(0)' id='"+element['objectID']+"_likes'  value='"+element['objectID']+"' onclick='likesBtn(this)'>"+
                                    "<li id='"+element['objectID']+"_likesIcon' class='fa "+ islike +"'>喜欢</li>"+
                                    "</a>"+
                                     element['likes']+
                                  "</div>"+
                                "</div>"+
                              "</div>"+
                            "</div>"+
                            "<br>"
                        ;
                    });
                    $('.itemsArea_SearchResult').append(HTML_TXT)//显示数据
                },
                error: function() {
                    alert("无结果");
                }
            });
        }
    })
    /*点赞功能*/
    function likesBtn(likesBtnDom){
        var id = likesBtnDom.id;
        console.log(id);
        $('#'+id+'Icon').toggleClass("fa-heart fa-heart-o");
    }
</script>

<!-- World 界面 end-->